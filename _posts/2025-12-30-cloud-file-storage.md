---
layout: posts
title: "[Cloud Service] File Storage Mount"
categories: ['cloud']
tags: [file storage]
---

클라우드 환경에서 파일스토리지는 여러 VM이 동시에 접근하거나, 상태 데이터를 유지해야 하는 서비스에서 자주 사용된다. UI나 API로 스토리지를 생성했다고 해서 테스트가 끝나는 것은 아니며, **실제로 VM에 마운트되고 정상적으로 읽기/쓰기가 가능한지**를 확인해야 한다.

아래는 **파일스토리지 마운트 및 기본 동작 검증 흐름**을 정리한다.

---

## 1. VM 접속

파일스토리지 마운트 테스트는 VM 내부에서 수행되므로, 먼저 SSH를 통해 VM에 접속한다.

```bash
ssh -i key.pem user@VM_IP
```

정상 접속 후 쉘 환경에 진입한 상태에서 다음 단계를 진행한다.

---

## 2. 마운트용 디렉터리 생성

파일스토리지는 특정 디렉터리에 마운트되므로, 마운트 포인트로 사용할 디렉터리를 생성한다.

```bash
sudo mkdir -p /mnt/filestorage
```

확인 포인트:

- 디렉터리가 정상적으로 생성되었는지
- 권한 문제 없이 접근 가능한지

---

## 3. 파일스토리지 마운트

스토리지 서버 주소와 마운트 옵션을 사용해 파일스토리지를 VM에 마운트한다.

```bash
sudo mount -t nfs STORAGE_IP:/export/path /mnt/filestorage
```

확인 포인트:

- 마운트 명령어 에러 여부
- 네트워크 연결 문제 발생 여부

마운트 상태는 다음 명령어로 확인한다.

```bash
mount | grep filestorage
```

---

## 4. 마운트 후 디렉터리 및 파일 생성 확인

마운트가 완료되면, 해당 디렉터리에서 파일 생성이 가능한지 확인한다.

```bash
cd /mnt/filestorage
touch test_file.txt
ls -l
```

확인 포인트:

- 파일 생성 성공 여부
- 권한 오류 발생 여부
- 로컬 디스크가 아닌 마운트 대상에 생성되는지

---

## 5. 테스트를 위한 더미 파일 생성

파일스토리지의 기본적인 쓰기 동작을 확인하기 위해 더미 파일을 생성한다.

```bash
dd if=/dev/zero of=dummy_file.bin bs=1M count=10
```

확인 포인트:

- 파일 생성 시간
- 에러 발생 여부
- 디스크 사용량 증가 확인

필요 시 파일 삭제 테스트도 함께 수행한다.

```bash
rm dummy_file.bin
```

---

## 6. 로컬 디렉터리 파일을 파일스토리지로 복사

파일스토리지가 실제로 활용 가능한지 확인하기 위해, **VM 로컬 디렉터리에 존재하는 파일을 마운트된 파일스토리지 디렉터리로 복사**한다.

예시로 로컬 디렉터리에 테스트 파일을 하나 생성한다.

```bash
cd ~
echo "local test file" > local_test.txt
```

이후 해당 파일을 파일스토리지 마운트 경로로 복사한다.

```bash
cp local_test.txt /mnt/filestorage/
```

복사 결과 확인:

```bash
ls -l /mnt/filestorage/
cat /mnt/filestorage/local_test.txt
```

확인 포인트:

- 로컬 디스크 → 파일스토리지로 파일 복사가 정상 수행되는지
- 복사 과정에서 권한 또는 I/O 에러가 발생하지 않는지
- 파일 내용이 손상 없이 유지되는지

이 과정은 단순 파일 생성보다, **실제 서비스 데이터 이동 시나리오에 더 가까운 검증**이다.

---

## 7. 기본 동작 검증 정리

파일스토리지 마운트 테스트에서 확인하는 핵심 포인트는 다음과 같다.

- VM에서 파일스토리지 접근 가능 여부
- 읽기/쓰기 동작 정상 여부
- 마운트 유지 상태

이 과정을 통해 콘솔에서 설정한 파일스토리지 구성이 실제 VM 환경에서도 정상적으로 동작하는지 확인할 수 있다.
