---
layout: posts
title: Charles Proxy
categories: ['sqa']
tags: [charles]
---
Charles Proxy
========
SQA 업무에서 Charles Proxy는 **클라이언트와 서버 사이의 실제 통신을 눈으로 확인하고, 의도적으로 변형하여 검증할 수 있는 핵심 도구**다. 단순히 API 요청·응답을 조회하는 수준을 넘어, 네트워크 장애 상황, 서버 오류, 예외 응답 등을 인위적으로 만들어낼 수 있기 때문에 UI 테스트만으로는 검증하기 어려운 시나리오를 효과적으로 보완한다.

특히 클라우드 콘솔, 웹 기반 서비스, 모바일 연동 서비스 테스트에서는 백엔드 환경을 직접 제어하기 어렵거나, 특정 오류 상태를 재현하기 힘든 경우가 많다. 이때 Charles를 활용하면 **서버 수정 없이도 다양한 상태 코드, 응답 데이터, 타이밍 이슈를 재현**할 수 있어 테스트 범위와 깊이를 크게 확장할 수 있다.

SQA 관점에서 Charles의 가장 큰 가치는 다음과 같다.

- 정상/비정상 네트워크 상황을 인위적으로 재현 가능
- API 스펙 대비 실제 동작 검증 가능
- UI, API, 인증 흐름을 함께 검증하는 통합 테스트 가능
- 자동화 테스트(Selenium, Python)와 병행 시 시나리오 확장

아래에서는 실무에서 가장 많이 사용하는 Charles 기능인 **Rewrite, Map Local, Breakpoint**를 중심으로 활용 방법과 테스트 관점을 정리한다.

---

## 1. Rewrite 사용하여 상태 코드 변경하기

### 개요

Rewrite는 특정 조건에 매칭되는 요청 또는 응답을 가로채어 **상태 코드, 헤더, 바디를 동적으로 변경**하는 기능이다. 서버를 수정하지 않고도 4xx, 5xx 오류 상황을 자유롭게 만들어낼 수 있어, 예외 처리와 오류 UI 검증에 매우 유용하다.

### 주요 활용 시나리오

- 정상 API를 401/403으로 변경하여 인증 만료·권한 오류 UI 검증
- 500, 503 응답을 만들어 서버 장애 시 화면 처리 확인
- 특정 API만 오류로 만들어 부분 장애 시나리오 테스트

### 설정 개념

1. Rewrite Rule 생성
2. 요청 URL, Method, Path 등으로 대상 API 지정
3. Response Rule에서 Status Code를 원하는 값으로 변경

<img width="1624" height="1045" alt="image" src="https://github.com/user-attachments/assets/21b94a12-aa35-4271-96ba-b0de95413f0f" />


### SQA 관점 포인트

- 서버에서 실제로 발생하지 않는 오류도 재현 가능
- QA 환경에서 재현 불가한 케이스를 로컬에서 검증 가능
- UI 테스트 + API 오류 검증을 동시에 수행 가능

---

## 2. Map Local 사용하여 API Response 변조하기

### 개요

Map Local은 특정 API 요청에 대해 **로컬에 저장된 응답 파일(JSON, XML 등)을 실제 서버 응답 대신 반환**하는 기능이다. 응답 구조를 자유롭게 설계할 수 있어 데이터 기반 테스트에 특히 효과적이다.

### 주요 활용 시나리오

- 응답 필드 누락, 타입 변경 등 비정상 데이터 검증
- 대량 데이터, 빈 리스트, 특정 플래그 값 고정 테스트
- 서버 데이터에 의존하지 않는 안정적인 UI 테스트

### 설정 개념

1. 대상 API URL 지정
2. 로컬 응답 파일(JSON 등) 매핑
3. 실제 서버 대신 로컬 응답 반환

<img width="1676" height="685" alt="image" src="https://github.com/user-attachments/assets/d6930ba2-be15-4286-8aa5-7f622941386a" />


### SQA 관점 포인트

- 서버 데이터 변경 없이 다양한 케이스 테스트 가능
- UI 단위 테스트를 API 상태와 분리하여 수행 가능
- 자동화 테스트(Selenium)와 조합 시 반복성·재현성 확보

---

## 3. Breakpoint 사용하여 원하는 요청 불러오기

### 개요

Breakpoint는 요청 또는 응답을 **전송 중간에 일시 정지**시켜 내용을 확인하고 수정한 뒤 다시 전송하는 기능이다. 실시간 디버깅과 흐름 분석에 적합하다.

### 주요 활용 시나리오

- 요청 파라미터를 수동으로 변경하여 서버 반응 확인
- 응답 데이터를 즉시 수정하여 UI 반응 확인
- 로그인, 토큰 발급, 인증 흐름 단계별 분석

### 설정 개념

1. Breakpoint 활성화 (Request / Response 선택)
2. 대상 API 또는 전체 트래픽 지정
3. 중단된 요청/응답 내용 수정 후 실행

<img width="1767" height="730" alt="image" src="https://github.com/user-attachments/assets/fe5e64f8-7bb7-4976-ad92-2889219d0831" />


### SQA 관점 포인트

- 실제 사용자 행동 흐름 기반 검증 가능
- 복잡한 인증·세션·토큰 흐름 이해에 도움
- Postman으로 재현 어려운 UI 연계 시나리오 검증 가능
